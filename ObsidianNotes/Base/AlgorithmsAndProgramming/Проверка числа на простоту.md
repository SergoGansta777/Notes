---
date created: 2022-05-31 11:02
tags:
  - '#Algorithm'
---
# Проверка числа на простоту

## Description

**Простое число** - это [натуральное число](https://www.webmath.ru/poleznoe/formules_2_1.php "Натуральные числа"), единственными делителями которого являются только оно само и единица.

#### Основная теорема арифметики

Каждое натуральное число, отличное от 1, может быть разложено на просые множители и притом единственным образом(если отождествлять раздожения p * q и q * p, где p и q - простые числа)

```ad-quote
Греческий математик Евклид доказал, что существует бесконечное множество простых чисел. Если у вас есть определенное количество простых чисел, например p1,… pn, вы можете рассмотреть число p1×…×pn + 1, которое на единицу больше, чем все простые числа, умноженные друг на друга. Это число не может быть произведением любых чисел p1,… pn из вашего списка, но оно точно больше, чем 1. Так что все простые множители должны быть простыми числами, которых нет в вашем списке. Добавляя новые простые числа в ваш список и повторяя те же действия, вы всегда можете найти по крайней мере одно новое простое число. Поэтому должно существовать бесконечное множество простых чисел.
```

### Наивный перебор

Беруться по очереди натуральные числа n, начиная с двойки и проверяюхся на простоту. Проверка на простоту заключается в следующем: перебирая числа k из диапазона от 2 до n-1 будем делить n на k с остатком. Если при каком-то k **обнаружится нулевой остаток**, значит n - составное число.
==Все простые числа==, за исключение двойки, ==нечётные==. Если ососбо обработать случай n=2, то все последующие числа n можно перебирать с шагом 2. Эт даст приблизительно двукратное увеличение производительности программы.

### Оптимизированный перебор делителей

Одно в улучшение возникает благодаря следующему утверждению: _наименьший делитель состаного числа_ n _не превосходит $\sqrt[2]{n}$_.

```ad-info
Докажем это утверждение от противного. Пускай число k является наименьший делителем n? причем k > $\sqrt[2]{n}$. Тогда n=kl, где l принадлежит N, причем l<=$\sqrt[2]{n}$, то есть l тфкже является делителем числа n, кроме того, меньшим k, а это противоречит предположению. 
```

Всё это означает, что ==оборвать перебор== делителей можно, когда k достигнет **$\sqrt[2]{n}$,** если **до этого момента не найдено делителей, то их нет вообще**.

```ad-hint
Кстати, при проверке на простоту числа 11 это наблюдение позволяет сократить перебор более чем в три раза, а для числа 11111111111111111 — более чем в 1064092553 раза (оба числа — простые).
```
#### Реализация в коде(своя, возможно не оптимальная)
```cpp
bool IsPrime(int N)
{
    for (int i = 2; i <= sqrt(N); i++)
        if (N % i == 0)
            return false;
    if (N < 2)
        return false;
    return true;
}
```
### Перебор с запоминанием найденных простых чисел(принцип динамического програмирования)
см. Подробнее: [Глава 14. Поиск простых чисел :: Идеи реализации](http://mech.math.msu.su/~shvetz/54/inf/perl-examples/PerlExamples_Primes_Ideas.xhtml)
- [ ] При необходимости доделывать